%L2 L4
 IC06 = [-0.20, 0.02;
-0.03, 0.58;
-0.40, 1.09;
-0.25, 1.60;
-0.19, 2.12;
-0.15, 2.64;
-0.11, 3.14;
-0.09, 3.66;
-0.06, 4.17;
-0.05, 4.69;
-0.04, 5.20;
-0.03, 5.72;
-0.02, 6.23;
-1.07, 6.75;
-0.56, 7.26;
-0.26, 7.77;
0.17, 8.28;
0.13, 8.79;
0.29, 9.30;
0.27, 9.80;
0.21, 10.31;
0.16, 10.83;
0.13, 11.34;
0.10, 11.85;
0.07, 12.36;
0.06, 12.87;
0.05, 13.38;
0.03, 13.90;
0.02, 14.42;
1.05, 14.93;
0.88, 15.44;
0.09, 15.96;
-0.10, 16.47;
-0.19, 16.99;
-0.20, 17.50;
-0.28, 18.02;
-0.22, 18.52;
-0.16, 19.03;
-0.13, 19.54;
-0.10, 20.06;
-0.08, 20.56;
-0.06, 21.07;
-0.04, 21.58;
-0.03, 22.10;
-0.03, 22.62;
-0.51, 23.13;
-0.66, 23.63;
-0.40, 24.14;
-0.17, 24.65;
0.12, 25.16;
0.28, 25.67;
0.30, 26.18;
0.23, 26.69;
0.19, 27.20;
0.14, 27.71;
0.11, 28.23;
0.09, 28.74;
0.06, 29.26;
0.05, 29.78;
0.03, 30.29;
0.03, 30.80;
0.05, 31.32;
0.86, 31.84;
0.49, 32.35;
0.24, 32.86;
-0.19, 33.37;
-0.12, 33.88;
-0.24, 34.39;
-0.26, 34.90;
-0.19, 35.41;
-0.15, 35.91;
-0.11, 36.42;
-0.09, 36.93;
-0.06, 37.45;
-0.05, 37.96;
-0.04, 38.48;
-0.03, 39.00;
-0.02, 39.52;
-1.10, 40.03;
-0.38, 40.54;
-0.14, 41.05;
-0.04, 41.57;
0.20, 42.08;
0.20, 42.60;
0.26, 43.11;
0.20, 43.62;
0.16, 44.13;
0.12, 44.64;
0.09, 45.15;
0.07, 45.67;
0.05, 46.18;
0.04, 46.70;
0.03, 47.22;
0.02, 47.73;
1.07, 48.23;
0.56, 48.74;
0.02, 49.24;
0.03, 49.75;
0.00, 50.26;
-0.24, 50.79;
-0.28, 51.30;
-0.21, 51.81;
-0.16, 52.32;
-0.13, 52.84;
-0.09, 53.35;
-0.08, 53.87;
-0.06, 54.38;
-0.05, 54.90;
-0.04, 55.42;
-0.02, 55.93;
-0.98, 56.45;
-0.60, 56.96;
-0.36, 57.46;
0.07, 57.98;
0.19, 58.50;
0.09, 59.01;
0.30, 59.52;
0.23, 60.03;
0.17, 60.54;
0.13, 61.06;
0.10, 61.56;
0.08, 62.08;
0.06, 62.60;
0.05, 63.12;
0.04, 63.63;
0.03, 64.15;
0.49, 64.67;
0.56, 65.20;
0.27, 65.73;
-0.10, 66.27;
0.02, 66.81;
-0.16, 67.36;
-0.28, 67.89;
-0.21, 68.44;
-0.16, 68.98;
-0.12, 69.52;
-0.09, 70.06;
-0.07, 70.59;
-0.05, 71.13;
-0.04, 71.66;
-0.03, 72.21;
-0.02, 72.75;
-1.05, 73.30;
-0.30, 73.82;
0.02, 74.36;
0.04, 74.90;
0.27, 75.46;
0.26, 76.00;
0.24, 76.54;
0.18, 77.08;
0.14, 77.62;
0.10, 78.16;
0.08, 78.71;
0.06, 79.25;
0.05, 79.79;
0.03, 80.33;
0.03, 80.87;
1.08, 81.42;
0.60, 81.95;
0.01, 82.50;
-0.05, 83.04;
-0.04, 83.59;
-0.31, 84.13;
-0.26, 84.67;
-0.20, 85.20;
-0.15, 85.75;
-0.11, 86.29;
-0.09, 86.83;
-0.06, 87.37;
-0.05, 87.92;
-0.04, 88.46;
-0.03, 89.00;
-0.03, 89.54;
-0.84, 90.08;
-0.40, 90.62;
-0.03, 91.16;
-0.03, 91.71;
0.06, 92.25;
0.29, 92.80;
0.22, 93.34;
0.17, 93.88;
0.12, 94.42;
0.10, 94.98;
0.07, 95.52;
0.05, 96.07;
0.04, 96.61;
0.03, 97.16;
0.02, 97.70;
1.01, 98.25;
0.34, 98.78;
0.26, 99.32;
0.00, 100.00;];

%%
Fs = 2000;
StopTime = 100;              % miliseconds
t = linspace(0, StopTime, length(IC06(:,2)))';

IC06(1:end,2) = t;

%%
YC06 = IC06(1:end,1);
XC06 = IC06(1:end,2);
L = length(YC06);
RMS = ones(L,1).*rms(YC06);

f = Fs*(0:(L/2))/L;
Y_ = fft(YC06);
P2 = abs(Y_/L);
P1 = P2(1:L/2+1);
P1(2:end-1) = 2*P1(2:end-1);

%% Sine wave
Fc = 60;                     % hertz
x = -127*sqrt(2)*sin(2*pi*t*120-(48*pi/180));
%x = -127*sqrt(2)*sin(2*pi*Fc*t);

%% Corrente e Tensão RMS
random = rand(150,1);
for i=1:150
    IrmsC06(i) = (rms(YC06)*1.05-rms(YC06)*0.95)*random(i)+rms(YC06)*0.95;
    VrmsC06(i) = (rms(x)*1.05-rms(x)*0.95)*random(i)+rms(x)*0.95;
end

IrmsC06 = IrmsC06';
VrmsC06 = VrmsC06';

%% Potência ativa, total e aparente
SC06 = VrmsC06.*IrmsC06;
PC06 = ones(length(VrmsC06),1)*(PL2+PL4);
for i=1:150
    PC06(i)=((PL2+PL4)*1.05-(PL2+PL4)*0.95)*random(i)+(PL2+PL4)*0.95;
end
QC06 = abs(sqrt(SC06.^2-PC06.^2));

%% Fator de potência
FpC06 = PC06./SC06;
if any(isnan(FpC06))
   FpC06 = 0;
end
%% Amplitude das harmônicas
[pks,locs] = findpeaks(P1,f,'MinPeakHeight',max(P1)/2);
findpeaks(P1,f,'MinPeakDistance',locs(1)*1.75)
[amp_harC06, f_har] = findpeaks(P1,f,'MinPeakDistance',locs(1)*1.75);
amp_harC06 = amp_harC06(1:length(amp_harC06)-1)';

MC06 = [IrmsC06 PC06 SC06 QC06 FpC06 zeros(150,7)];
for i=1:150
    MC06(i,6)=(amp_harC06(1)*1.05-amp_harC06(1)*0.95)*random(i)+amp_harC06(1)*0.95;
    MC06(i,7)=(amp_harC06(2)*1.05-amp_harC06(2)*0.95)*random(i)+amp_harC06(2)*0.95;
    MC06(i,8)=(amp_harC06(3)*1.05-amp_harC06(3)*0.95)*random(i)+amp_harC06(3)*0.95;
    MC06(i,9)=(amp_harC06(4)*1.05-amp_harC06(4)*0.95)*random(i)+amp_harC06(4)*0.95;
    MC06(i,10)=(amp_harC06(5)*1.05-amp_harC06(5)*0.95)*random(i)+amp_harC06(5)*0.95;
    MC06(i,11)=(amp_harC06(6)*1.05-amp_harC06(6)*0.95)*random(i)+amp_harC06(6)*0.95;
    MC06(i,12)=(amp_harC06(7)*1.05-amp_harC06(7)*0.95)*random(i)+amp_harC06(7)*0.95;
end