%L1 L4
 IC10 = [0.46, 0.02;
0.95, 0.57;
0.50, 1.07;
-0.01, 1.58;
0.02, 2.10;
-0.10, 2.62;
-0.31, 3.14;
-0.24, 3.66;
-0.18, 4.17;
-0.15, 4.68;
-0.11, 5.19;
-0.08, 5.71;
-0.06, 6.22;
-0.05, 6.74;
-0.04, 7.26;
-0.03, 7.78;
-0.02, 8.28;
-1.04, 8.80;
-0.57, 9.30;
0.01, 9.80;
0.09, 10.32;
0.26, 10.84;
0.32, 11.35;
0.25, 11.86;
0.20, 12.36;
0.15, 12.88;
0.11, 13.39;
0.09, 13.91;
0.07, 14.42;
0.05, 14.93;
0.04, 15.44;
0.03, 15.96;
0.02, 16.48;
1.13, 16.99;
0.65, 17.50;
0.28, 18.00;
0.10, 18.51;
-0.12, 19.02;
-0.24, 19.54;
-0.26, 20.05;
-0.21, 20.56;
-0.16, 21.07;
-0.12, 21.58;
-0.10, 22.10;
-0.07, 22.62;
-0.06, 23.13;
-0.05, 23.64;
-0.03, 24.16;
-0.03, 24.68;
-1.14, 25.19;
-0.70, 25.74;
-0.07, 26.26;
-0.12, 26.76;
0.14, 27.28;
0.09, 27.80;
0.27, 28.32;
0.22, 28.82;
0.16, 29.33;
0.12, 29.84;
0.10, 30.35;
0.08, 30.86;
0.05, 31.38;
0.04, 31.90;
0.03, 32.41;
0.02, 32.91;
0.39, 33.43;
0.68, 33.94;
0.17, 34.45;
-0.12, 34.95;
-0.14, 35.47;
-0.17, 35.98;
-0.29, 36.49;
-0.23, 37.00;
-0.17, 37.52;
-0.14, 38.02;
-0.10, 38.54;
-0.08, 39.05;
-0.06, 39.57;
-0.05, 40.09;
-0.04, 40.60;
-0.03, 41.12;
-0.23, 41.64;
-0.86, 42.15;
-0.23, 42.67;
-0.10, 43.17;
0.12, 43.68;
0.22, 44.18;
0.32, 44.70;
0.24, 45.20;
0.18, 45.72;
0.14, 46.22;
0.11, 46.74;
0.09, 47.25;
0.06, 47.77;
0.04, 48.28;
0.04, 48.79;
0.03, 49.30;
0.02, 49.81;
1.02, 50.32;
0.52, 50.83;
0.22, 51.34;
-0.14, 51.85;
-0.20, 52.36;
-0.17, 52.88;
-0.25, 53.38;
-0.20, 53.90;
-0.15, 54.40;
-0.12, 54.93;
-0.09, 55.44;
-0.07, 55.96;
-0.06, 56.47;
-0.04, 56.99;
-0.03, 57.50;
-0.03, 58.02;
-0.90, 58.54;
-0.61, 59.05;
-0.22, 59.56;
0.15, 60.07;
0.13, 60.58;
0.27, 61.10;
0.26, 61.61;
0.21, 62.13;
0.16, 62.64;
0.12, 63.16;
0.09, 63.67;
0.07, 64.19;
0.05, 64.70;
0.04, 65.24;
0.03, 65.77;
0.03, 66.32;
1.14, 66.85;
0.64, 67.39;
0.18, 67.93;
-0.00, 68.48;
-0.09, 69.02;
-0.26, 69.56;
-0.24, 70.10;
-0.18, 70.63;
-0.14, 71.17;
-0.11, 71.71;
-0.08, 72.26;
-0.06, 72.80;
-0.05, 73.35;
-0.04, 73.89;
-0.03, 74.43;
-0.65, 74.97;
-0.79, 75.52;
-0.30, 76.05;
-0.06, 76.59;
0.12, 77.14;
0.25, 77.68;
0.27, 78.22;
0.20, 78.76;
0.15, 79.30;
0.12, 79.83;
0.09, 80.37;
0.07, 80.91;
0.05, 81.46;
0.04, 82.00;
0.03, 82.54;
0.02, 83.08;
0.83, 83.62;
0.52, 84.15;
0.03, 84.70;
-0.01, 85.24;
-0.22, 85.79;
-0.29, 86.33;
-0.23, 86.88;
-0.17, 87.42;
-0.13, 87.96;
-0.10, 88.50;
-0.07, 89.04;
-0.06, 89.59;
-0.05, 90.14;
-0.03, 90.69;
-0.02, 91.23;
-1.16, 91.78;
-0.57, 92.32;
-0.24, 92.87;
0.07, 93.41;
0.18, 93.95;
0.36, 94.50;
0.24, 95.05;
0.18, 95.58;
0.14, 96.12;
0.11, 96.66;
0.08, 97.20;
0.06, 97.74;
0.05, 98.27;
0.04, 98.81;
0.03, 99.35;
0.00, 100.00;];

%%
Fs = 2000;
StopTime = 100;              % miliseconds
t = linspace(0, StopTime, length(IC10(:,2)))';

IC10(1:end,2) = t;

%%
YC10 = IC10(1:end,1);
XC10 = IC10(1:end,2);
L = length(YC10);
RMS = ones(L,1).*rms(YC10);

f = Fs*(0:(L/2))/L;
Y_ = fft(YC10);
P2 = abs(Y_/L);
P1 = P2(1:L/2+1);
P1(2:end-1) = 2*P1(2:end-1);

%% Sine wave
Fc = 60;                     % hertz
x = -127*sqrt(2)*sin(2*pi*t*120-(48*pi/180));
%x = -127*sqrt(2)*sin(2*pi*Fc*t);

%% Corrente e Tensão RMS
random = rand(150,1);
for i=1:150
    IrmsC10(i) = (rms(YC10)*1.05-rms(YC10)*0.95)*random(i)+rms(YC10)*0.95;
    VrmsC10(i) = (rms(x)*1.05-rms(x)*0.95)*random(i)+rms(x)*0.95;
end

IrmsC10 = IrmsC10';
VrmsC10 = VrmsC10';

%% Potência ativa, total e aparente
SC10 = VrmsC10.*IrmsC10;
PC10 = ones(length(VrmsC10),1)*(PL1+PL4);
for i=1:150
    PC10(i)=((PL1+PL4)*1.05-(PL1+PL4)*0.95)*random(i)+(PL1+PL4)*0.95;
end
QC10 = abs(sqrt(SC10.^2-PC10.^2));

%% Fator de potência
FpC10 = PC10./SC10;
if any(isnan(FpC10))
   FpC10 = 0;
end
%% Amplitude das harmônicas
[pks,locs] = findpeaks(P1,f,'MinPeakHeight',max(P1)/2);
findpeaks(P1,f,'MinPeakDistance',locs(1)*1.75)
[amp_harC10, f_har] = findpeaks(P1,f,'MinPeakDistance',locs(1)*1.75);
amp_harC10 = amp_harC10(1:length(amp_harC10)-1)';

MC10 = [IrmsC10 PC10 SC10 QC10 FpC10 zeros(150,7)];
for i=1:150
    MC10(i,6)=(amp_harC10(1)*1.05-amp_harC10(1)*0.95)*random(i)+amp_harC10(1)*0.95;
    MC10(i,7)=(amp_harC10(2)*1.05-amp_harC10(2)*0.95)*random(i)+amp_harC10(2)*0.95;
    MC10(i,8)=(amp_harC10(3)*1.05-amp_harC10(3)*0.95)*random(i)+amp_harC10(3)*0.95;
    MC10(i,9)=(amp_harC10(4)*1.05-amp_harC10(4)*0.95)*random(i)+amp_harC10(4)*0.95;
    MC10(i,10)=(amp_harC10(5)*1.05-amp_harC10(5)*0.95)*random(i)+amp_harC10(5)*0.95;
    MC10(i,11)=(amp_harC10(6)*1.05-amp_harC10(6)*0.95)*random(i)+amp_harC10(6)*0.95;
    MC10(i,12)=(amp_harC10(7)*1.05-amp_harC10(7)*0.95)*random(i)+amp_harC10(7)*0.95;
end