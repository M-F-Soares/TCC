% %11W L1
 IC09 = [-0.05, 0.02;
-0.04, 0.58;
-0.03, 1.09;
-0.02, 1.61;
-0.02, 2.12;
-0.02, 2.64;
-0.01, 3.14;
-0.59, 3.66;
-0.25, 4.17;
-0.16, 4.68;
0.05, 5.19;
0.10, 5.70;
0.09, 6.22;
0.13, 6.73;
0.10, 7.24;
0.07, 7.76;
0.05, 8.27;
0.04, 8.79;
0.03, 9.30;
0.02, 9.81;
0.02, 10.32;
0.01, 10.84;
0.01, 11.35;
0.64, 11.87;
0.38, 12.38;
0.14, 12.89;
0.03, 13.40;
-0.06, 13.90;
-0.06, 14.42;
-0.14, 14.94;
-0.11, 15.45;
-0.08, 15.97;
-0.07, 16.48;
-0.05, 17.00;
-0.04, 17.51;
-0.03, 18.02;
-0.02, 18.53;
-0.01, 19.05;
-0.01, 19.56;
-0.31, 20.08;
-0.32, 20.59;
-0.11, 21.10;
-0.10, 21.61;
0.11, 22.13;
0.11, 22.64;
0.15, 23.16;
0.11, 23.67;
0.08, 24.18;
0.06, 24.68;
0.04, 25.20;
0.03, 25.72;
0.03, 26.24;
0.02, 26.75;
0.01, 27.27;
0.01, 27.78;
0.01, 28.30;
0.37, 28.81;
0.27, 29.32;
0.02, 29.82;
0.01, 30.34;
-0.10, 30.86;
-0.15, 31.37;
-0.12, 31.89;
-0.09, 32.42;
-0.07, 32.93;
-0.05, 33.45;
-0.04, 33.96;
-0.03, 34.48;
-0.02, 34.99;
-0.02, 35.51;
-0.01, 36.02;
-0.01, 36.54;
-0.47, 37.06;
-0.19, 37.57;
-0.03, 38.07;
-0.01, 38.59;
0.04, 39.10;
0.13, 39.62;
0.12, 40.13;
0.10, 40.64;
0.07, 41.15;
0.06, 41.67;
0.04, 42.17;
0.03, 42.69;
0.03, 43.21;
0.01, 43.72;
0.01, 44.23;
0.01, 44.75;
0.53, 45.26;
0.24, 45.78;
0.05, 46.28;
-0.00, 46.79;
-0.08, 47.31;
-0.11, 47.83;
-0.13, 48.34;
-0.10, 48.86;
-0.07, 49.36;
-0.06, 49.88;
-0.04, 50.40;
-0.03, 50.92;
-0.03, 51.43;
-0.02, 51.95;
-0.02, 52.46;
-0.01, 52.98;
-0.51, 53.50;
-0.37, 54.01;
-0.08, 54.52;
-0.02, 55.03;
0.09, 55.54;
0.15, 56.06;
0.13, 56.57;
0.10, 57.08;
0.08, 57.59;
0.06, 58.11;
0.05, 58.62;
0.04, 59.14;
0.03, 59.66;
0.02, 60.17;
0.01, 60.68;
0.01, 61.21;
0.38, 61.72;
0.40, 62.23;
0.10, 62.74;
-0.02, 63.26;
-0.07, 63.78;
-0.17, 64.30;
-0.14, 64.82;
-0.10, 65.35;
-0.08, 65.90;
-0.06, 66.44;
-0.04, 66.98;
-0.04, 67.52;
-0.03, 68.06;
-0.02, 68.61;
-0.01, 69.15;
-0.01, 69.69;
-0.44, 70.23;
-0.28, 70.77;
0.01, 71.31;
-0.01, 71.85;
0.05, 72.40;
0.10, 72.94;
0.11, 73.48;
0.09, 74.02;
0.07, 74.56;
0.05, 75.10;
0.04, 75.66;
0.03, 76.19;
0.02, 76.74;
0.02, 77.28;
0.01, 77.82;
0.40, 78.37;
0.38, 78.91;
0.00, 79.45;
-0.08, 80.00;
-0.10, 80.54;
-0.14, 81.08;
-0.13, 81.63;
-0.10, 82.17;
-0.08, 82.72;
-0.05, 83.27;
-0.04, 83.81;
-0.03, 84.35;
-0.03, 84.90;
-0.02, 85.44;
-0.01, 85.98;
-0.00, 86.52;
-0.24, 87.07;
-0.11, 87.61;
0.07, 88.15;
0.13, 88.69;
0.05, 89.23;
0.14, 89.78;
0.10, 90.31;
0.08, 90.86;
0.06, 91.40;
0.04, 91.94;
0.03, 92.48;
0.03, 93.02;
0.02, 93.56;
0.02, 94.10;
0.01, 94.64;
0.39, 95.18;
0.24, 95.73;
0.04, 96.27;
-0.03, 96.81;
-0.02, 97.35;
-0.10, 97.90;
-0.12, 98.44;
-0.09, 98.99;
0.00, 99.98;
0.00, 100.00;];

%%
Fs = 2000;
StopTime = 100;              % miliseconds
t = linspace(0, StopTime, length(IC09(:,2)))';

IC09(1:end,2) = t;

%%
YC09 = IC09(1:end,1);
XC09 = IC09(1:end,2);
L = length(YC09);
RMS = ones(L,1).*rms(YC09);

f = Fs*(0:(L/2))/L;
Y_ = fft(YC09);
P2 = abs(Y_/L);
P1 = P2(1:L/2+1);
P1(2:end-1) = 2*P1(2:end-1);

%% Sine wave
Fc = 60;                     % hertz
x = -127*sqrt(2)*sin(2*pi*t*120-(48*pi/180));
%x = -127*sqrt(2)*sin(2*pi*Fc*t);

%% Corrente e Tensão RMS
random = rand(150,1);
for i=1:150
    IrmsC09(i) = (rms(YC09)*1.05-rms(YC09)*0.95)*random(i)+rms(YC09)*0.95;
    VrmsC09(i) = (rms(x)*1.05-rms(x)*0.95)*random(i)+rms(x)*0.95;
end

IrmsC09 = IrmsC09';
VrmsC09 = VrmsC09';

%% Potência ativa, total e aparente
SC09 = VrmsC09.*IrmsC09;
PC09 = ones(length(VrmsC09),1)*PL1;
for i=1:150
    PC09(i)=(PL1*1.05-PL1*0.95)*random(i)+PL1*0.95;
end
QC09 = abs(sqrt(SC09.^2-PC09.^2));

%% Fator de potência
FpC09 = PC09./SC09;
if any(isnan(FpC09))
   FpC09 = 0;
end
%% Amplitude das harmônicas
[pks,locs] = findpeaks(P1,f,'MinPeakHeight',max(P1)/2);
findpeaks(P1,f,'MinPeakDistance',locs(1)*1.75)
[amp_harC09, f_har] = findpeaks(P1,f,'MinPeakDistance',locs(1)*1.75);
amp_harC09 = amp_harC09(1:length(amp_harC09)-1)';

MC09 = [IrmsC09 PC09 SC09 QC09 FpC09 zeros(150,7)];
for i=1:150
    MC09(i,6)=(amp_harC09(1)*1.05-amp_harC09(1)*0.95)*random(i)+amp_harC09(1)*0.95;
    MC09(i,7)=(amp_harC09(2)*1.05-amp_harC09(2)*0.95)*random(i)+amp_harC09(2)*0.95;
    MC09(i,8)=(amp_harC09(3)*1.05-amp_harC09(3)*0.95)*random(i)+amp_harC09(3)*0.95;
    MC09(i,9)=(amp_harC09(4)*1.05-amp_harC09(4)*0.95)*random(i)+amp_harC09(4)*0.95;
    MC09(i,10)=(amp_harC09(5)*1.05-amp_harC09(5)*0.95)*random(i)+amp_harC09(5)*0.95;
    MC09(i,11)=(amp_harC09(6)*1.05-amp_harC09(6)*0.95)*random(i)+amp_harC09(6)*0.95;
    MC09(i,12)=(amp_harC09(7)*1.05-amp_harC09(7)*0.95)*random(i)+amp_harC09(7)*0.95;
end