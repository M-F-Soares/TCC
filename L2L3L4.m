%L2 L3 L4
 IC08 = [-0.23, 0.02;
-0.18, 0.58;
-0.13, 1.08;
-0.10, 1.61;
-0.08, 2.12;
-0.07, 2.64;
-0.05, 3.14;
-0.04, 3.66;
-1.45, 4.17;
-0.78, 4.68;
-0.36, 5.18;
0.14, 5.70;
0.22, 6.20;
0.39, 6.72;
0.41, 7.23;
0.32, 7.75;
0.24, 8.26;
0.20, 8.77;
0.14, 9.28;
0.11, 9.79;
0.09, 10.30;
0.07, 10.82;
0.05, 11.32;
0.04, 11.84;
1.58, 12.35;
1.06, 12.86;
0.31, 13.37;
0.10, 13.88;
-0.24, 14.39;
-0.29, 14.91;
-0.43, 15.41;
-0.34, 15.94;
-0.26, 16.44;
-0.20, 16.96;
-0.16, 17.47;
-0.12, 17.98;
-0.10, 18.49;
-0.07, 19.01;
-0.06, 19.52;
-0.05, 20.04;
-1.18, 20.55;
-1.00, 21.06;
-0.31, 21.56;
0.04, 22.08;
0.04, 22.59;
0.24, 23.11;
0.46, 23.62;
0.35, 24.12;
0.27, 24.63;
0.21, 25.14;
0.17, 25.65;
0.13, 26.17;
0.10, 26.68;
0.08, 27.20;
0.06, 27.72;
0.05, 28.24;
0.11, 28.75;
1.11, 29.27;
0.50, 29.78;
0.04, 30.29;
-0.01, 30.80;
-0.21, 31.32;
-0.39, 31.84;
-0.38, 32.35;
-0.29, 32.86;
-0.22, 33.37;
-0.17, 33.88;
-0.13, 34.39;
-0.10, 34.90;
-0.08, 35.41;
-0.06, 35.91;
-0.05, 36.42;
-0.04, 36.93;
-1.71, 37.45;
-0.84, 37.96;
-0.21, 38.47;
0.02, 38.98;
0.15, 39.49;
0.29, 40.00;
0.40, 40.51;
0.31, 41.02;
0.25, 41.53;
0.19, 42.03;
0.14, 42.55;
0.11, 43.06;
0.09, 43.58;
0.07, 44.09;
0.05, 44.61;
0.04, 45.13;
1.75, 45.64;
1.03, 46.15;
0.17, 46.66;
-0.05, 47.17;
-0.05, 47.69;
-0.30, 48.20;
-0.43, 48.71;
-0.33, 49.22;
-0.25, 49.74;
-0.19, 50.24;
-0.15, 50.75;
-0.12, 51.26;
-0.09, 51.78;
-0.07, 52.29;
-0.05, 52.80;
-0.04, 53.32;
-1.27, 53.84;
-1.16, 54.34;
-0.17, 54.85;
-0.08, 55.36;
0.03, 55.88;
0.30, 56.39;
0.45, 56.90;
0.35, 57.41;
0.27, 57.93;
0.21, 58.44;
0.16, 58.96;
0.13, 59.47;
0.10, 59.98;
0.08, 60.50;
0.06, 61.01;
0.05, 61.53;
0.37, 62.05;
1.03, 62.56;
0.57, 63.07;
0.04, 63.58;
-0.04, 64.10;
-0.23, 64.62;
-0.49, 65.14;
-0.35, 65.68;
-0.27, 66.22;
-0.21, 66.76;
-0.16, 67.30;
-0.12, 67.84;
-0.09, 68.38;
-0.07, 68.92;
-0.05, 69.46;
-0.04, 70.00;
-1.65, 70.54;
-0.79, 71.08;
-0.31, 71.61;
-0.10, 72.14;
0.23, 72.68;
0.32, 73.22;
0.41, 73.76;
0.30, 74.31;
0.24, 74.84;
0.18, 75.39;
0.14, 75.92;
0.11, 76.47;
0.08, 77.01;
0.06, 77.55;
0.05, 78.10;
0.23, 78.65;
1.31, 79.19;
0.47, 79.73;
-0.05, 80.26;
-0.15, 80.80;
-0.29, 81.34;
-0.45, 81.87;
-0.34, 82.41;
-0.26, 82.96;
-0.20, 83.50;
-0.15, 84.04;
-0.12, 84.58;
-0.09, 85.12;
-0.06, 85.67;
-0.05, 86.21;
-0.03, 86.75;
-1.67, 87.29;
-0.82, 87.83;
-0.09, 88.36;
0.14, 88.91;
0.24, 89.45;
0.50, 89.99;
0.38, 90.52;
0.29, 91.06;
0.22, 91.60;
0.17, 92.14;
0.13, 92.68;
0.10, 93.23;
0.08, 93.77;
0.06, 94.31;
0.04, 94.86;
1.46, 95.41;
1.09, 95.95;
0.22, 96.48;
-0.06, 97.03;
-0.15, 97.57;
-0.38, 98.11;
-0.41, 98.64;
-0.31, 99.18;
0.00, 99.98;];

%%
Fs = 2000;
StopTime = 100;              % miliseconds
t = linspace(0, StopTime, length(IC08(:,2)))';

IC08(1:end,2) = t;

%%
YC08 = IC08(1:end,1);
XC08 = IC08(1:end,2);
L = length(YC08);
RMS = ones(L,1).*rms(YC08);

f = Fs*(0:(L/2))/L;
Y_ = fft(YC08);
P2 = abs(Y_/L);
P1 = P2(1:L/2+1);
P1(2:end-1) = 2*P1(2:end-1);

%% Sine wave
Fc = 60;                     % hertz
x = -127*sqrt(2)*sin(2*pi*t*120-(48*pi/180));
%x = -127*sqrt(2)*sin(2*pi*Fc*t);

%% Corrente e Tensão RMS
random = rand(150,1);
for i=1:150
    IrmsC08(i) = (rms(YC08)*1.05-rms(YC08)*0.95)*random(i)+rms(YC08)*0.95;
    VrmsC08(i) = (rms(x)*1.05-rms(x)*0.95)*random(i)+rms(x)*0.95;
end

IrmsC08 = IrmsC08';
VrmsC08 = VrmsC08';

%% Potência ativa, total e aparente
SC08 = VrmsC08.*IrmsC08;
PC08 = ones(length(VrmsC08),1)*(PL2+PL3+PL4);
for i=1:150
    PC08(i)=((PL2+PL3+PL4)*1.05-(PL2+PL3+PL4)*0.95)*random(i)+(PL2+PL3+PL4)*0.95;
end
QC08 = abs(sqrt(SC08.^2-PC08.^2));

%% Fator de potência
FpC08 = PC08./SC08;
if any(isnan(FpC08))
   FpC08 = 0;
end
%% Amplitude das harmônicas
[pks,locs] = findpeaks(P1,f,'MinPeakHeight',max(P1)/2);
findpeaks(P1,f,'MinPeakDistance',locs(1)*1.75)
[amp_harC08, f_har] = findpeaks(P1,f,'MinPeakDistance',locs(1)*1.75);
amp_harC08 = amp_harC08(1:length(amp_harC08)-1)';

MC08 = [IrmsC08 PC08 SC08 QC08 FpC08 zeros(150,7)];
for i=1:150
    MC08(i,6)=(amp_harC08(1)*1.05-amp_harC08(1)*0.95)*random(i)+amp_harC08(1)*0.95;
    MC08(i,7)=(amp_harC08(2)*1.05-amp_harC08(2)*0.95)*random(i)+amp_harC08(2)*0.95;
    MC08(i,8)=(amp_harC08(3)*1.05-amp_harC08(3)*0.95)*random(i)+amp_harC08(3)*0.95;
    MC08(i,9)=(amp_harC08(4)*1.05-amp_harC08(4)*0.95)*random(i)+amp_harC08(4)*0.95;
    MC08(i,10)=(amp_harC08(5)*1.05-amp_harC08(5)*0.95)*random(i)+amp_harC08(5)*0.95;
    MC08(i,11)=(amp_harC08(6)*1.05-amp_harC08(6)*0.95)*random(i)+amp_harC08(6)*0.95;
    MC08(i,12)=(amp_harC08(7)*1.05-amp_harC08(7)*0.95)*random(i)+amp_harC08(7)*0.95;
end