% NENHUMA
IC01 = [-0.00, 0.02;
0.01, 0.52;
0.00, 1.04;
-0.00, 1.56;
0.00, 2.09;
-0.00, 2.61;
-0.00, 3.14;
-0.00, 3.67;
0.01, 4.20;
-0.00, 4.72;
0.00, 5.24;
0.00, 5.77;
0.00, 6.28;
-0.00, 6.80;
-0.00, 7.32;
-0.00, 7.86;
0.00, 8.39;
0.01, 8.91;
-0.00, 9.42;
0.00, 9.95;
-0.00, 10.46;
-0.00, 10.98;
0.00, 11.50;
-0.00, 12.02;
-0.00, 12.54;
0.00, 13.06;
-0.00, 13.58;
-0.00, 14.10;
-0.00, 14.63;
-0.00, 15.16;
0.00, 15.68;
0.00, 16.20;
-0.00, 16.72;
-0.00, 17.24;
0.00, 17.76;
0.00, 18.28;
0.00, 18.79;
0.00, 19.31;
-0.00, 19.82;
-0.00, 20.35;
-0.00, 20.87;
0.01, 21.39;
-0.00, 21.90;
-0.00, 22.42;
0.00, 22.94;
0.00, 23.46;
-0.00, 23.97;
-0.00, 24.49;
-0.00, 25.00;
-0.00, 25.52;
0.00, 26.05;
-0.00, 26.56;
-0.00, 27.08;
0.00, 27.60;
-0.00, 28.11;
-0.00, 28.63;
-0.00, 29.15;
0.00, 29.67;
-0.00, 30.18;
-0.00, 30.71;
-0.00, 31.23;
0.00, 31.76;
-0.00, 32.28;
-0.00, 32.81;
-0.00, 33.33;
-0.00, 33.85;
-0.00, 34.38;
0.00, 34.89;
0.01, 35.42;
-0.00, 35.93;
-0.00, 36.45;
-0.00, 36.97;
-0.00, 37.50;
-0.00, 38.02;
-0.00, 38.55;
-0.00, 39.07;
-0.00, 39.60;
-0.00, 40.11;
0.00, 40.64;
0.00, 41.16;
0.00, 41.68;
-0.00, 42.19;
-0.00, 42.71;
0.00, 43.23;
0.01, 43.75;
0.00, 44.26;
0.00, 44.78;
-0.00, 45.30;
-0.00, 45.82;
-0.00, 46.34;
-0.00, 46.87;
-0.00, 47.39;
-0.00, 47.92;
0.00, 48.44;
-0.00, 48.96;
0.00, 49.48;
-0.00, 50.00;
-0.00, 50.52;
0.01, 51.04;
-0.00, 51.56;
-0.00, 52.09;
0.00, 52.61;
0.00, 53.12;
0.01, 53.64;
-0.00, 54.14;
0.00, 54.66;
-0.00, 55.18;
-0.00, 55.69;
-0.00, 56.22;
-0.00, 56.73;
-0.00, 57.26;
0.00, 57.78;
-0.00, 58.30;
-0.00, 58.81;
0.00, 59.33;
-0.00, 59.85;
0.00, 60.36;
0.00, 60.88;
0.00, 61.40;
-0.00, 61.92;
-0.00, 62.45;
-0.00, 62.97;
-0.00, 63.50;
-0.00, 64.02;
-0.00, 64.54;
-0.00, 65.07;
-0.00, 65.62;
0.00, 66.18;
0.00, 66.72;
0.00, 67.26;
0.01, 67.81;
0.00, 68.36;
-0.00, 68.90;
-0.00, 69.46;
-0.00, 70.00;
-0.00, 70.56;
-0.00, 71.10;
-0.00, 71.66;
0.00, 72.21;
-0.00, 72.75;
-0.00, 73.25;
-0.00, 73.80;
0.00, 74.36;
0.00, 74.90;
0.00, 75.45;
0.00, 76.00;
-0.00, 76.55;
-0.00, 77.10;
0.00, 77.65;
0.00, 78.20;
-0.00, 78.74;
0.00, 79.29;
0.00, 79.83;
0.00, 80.38;
-0.00, 80.92;
0.00, 81.48;
0.00, 82.03;
0.00, 82.58;
-0.00, 83.12;
-0.00, 83.68;
0.00, 84.23;
-0.00, 84.78;
-0.00, 85.33;
-0.00, 85.88;
-0.00, 86.42;
0.00, 86.97;
0.00, 87.52;
0.01, 88.07;
-0.00, 88.62;
-0.00, 89.17;
-0.00, 89.73;
-0.00, 90.27;
-0.00, 90.83;
0.00, 91.38;
0.00, 91.94;
0.00, 92.48;
-0.00, 93.04;
-0.00, 93.59;
0.00, 94.14;
-0.00, 94.68;
-0.00, 95.18;
-0.00, 95.73;
0.00, 96.28;
-0.00, 96.83;
-0.00, 97.38;
-0.00, 97.93;
-0.00, 98.48;
-0.00, 99.04;
0.00, 99.96;
0.00, 100.00;
0.00, 100.00;
0.00, 100.00;];

%%
Fs = 2000;
StopTime = 100;              % miliseconds
t = linspace(0, StopTime, length(IC01(:,2)))';

IC01(1:end,1) = zeros(length(IC01(:,2)),1);
IC01(1:end,2) = t;

%%

YC01 = IC01(1:end,1);
XC01 = IC01(1:end,2);
L = length(YC01);
RMS = ones(L,1).*rms(YC01);

f = Fs*(0:(L/2))/L;
Y_ = fft(YC01);
P2 = abs(Y_/L);
P1 = P2(1:L/2+1);
P1(2:end-1) = 2*P1(2:end-1);

%% Sine wave
Fc = 60;                     % hertz
x = -127*sqrt(2)*sin(2*pi*t*120-(48*pi/180));

%% Corrente e Tensão RMS
Irms = rms(YC01);
Vrms = rms(x);

%% Potência ativa, total e aparente
SC01 = Vrms*Irms;
PC01 = 0;
QC01 = sqrt(SC01.^2-PC01.^2);

%% Fator de potência
FpC01 = PC01/SC01;
if any(isnan(FpC01))
   FpC01 = 0;
end
%% Amplitude das harmônicas
amp_harC01 = zeros(7,1)';

%%

for i=1:7
    amp_Har_(:,i) = (amp_harC01(:,i)-min(amp_harC01(:,i)))./(max(amp_harC01(:,i))-min(amp_harC01(:,i)));
    if any(isnan(amp_Har_(:)))
        amp_Har_(:,i) = 0;
    end
end

MC01 = [Irms PC01 SC01 QC01 FpC01 amp_Har_];

for i=1:150
    MC01(i,:) = [Irms PC01 SC01 QC01 FpC01 amp_Har_];
end